<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å°å°é’¢ç´</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            min-height: 100vh;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            padding: 20px;
        }

        h1 {
            color: #fff;
            font-size: 2.5rem;
            margin-bottom: 20px;
            text-shadow: 0 0 20px rgba(255, 255, 255, 0.3);
        }

        .piano {
            display: flex;
            background: linear-gradient(145deg, #2c3e50, #1a252f);
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
        }

        .white-key {
            width: 50px;
            height: 180px;
            background: linear-gradient(145deg, #fff, #ecf0f1);
            border: 1px solid #bdc3c7;
            border-radius: 0 0 5px 5px;
            cursor: pointer;
            transition: all 0.1s ease;
            display: flex;
            align-items: flex-end;
            justify-content: center;
            padding-bottom: 10px;
            font-weight: bold;
            color: #7f8c8d;
        }

        .white-key:hover {
            background: linear-gradient(145deg, #fff, #ddd);
        }

        .white-key:active, .white-key.playing {
            background: linear-gradient(145deg, #ddd, #bbb);
            transform: translateY(3px);
            box-shadow: inset 0 3px 10px rgba(0,0,0,0.2);
        }

        .black-key {
            width: 35px;
            height: 110px;
            background: linear-gradient(145deg, #2c3e50, #000);
            margin-left: -17px;
            margin-right: -17px;
            border-radius: 0 0 3px 3px;
            z-index: 1;
            cursor: pointer;
            transition: all 0.1s ease;
        }

        .black-key:hover {
            background: linear-gradient(145deg, #34495e, #1a1a1a);
        }

        .black-key:active, .black-key.playing {
            background: linear-gradient(145deg, #1a1a1a, #000);
            transform: translateY(3px);
        }

        .songs {
            margin-top: 30px;
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
            max-width: 500px;
        }

        .song-btn {
            padding: 12px 20px;
            font-size: 1rem;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 2px solid white;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .song-btn:hover {
            background: white;
            color: #667eea;
        }

        .song-btn.playing {
            background: #f1c40f;
            border-color: #f1c40f;
            color: #333;
        }

        .note-display {
            margin-top: 20px;
            font-size: 2rem;
            color: white;
            min-height: 50px;
        }

        .hint {
            color: rgba(255,255,255,0.7);
            margin-top: 15px;
            font-size: 0.9rem;
        }
    </style>
</head>
<body>
    <h1>ğŸ¹ å°å°é’¢ç´</h1>

    <div class="piano" id="piano"></div>

    <div class="note-display" id="noteDisplay"></div>

    <div class="songs">
        <button class="song-btn" onclick="playSong('å°æ˜Ÿæ˜Ÿ')">â­ å°æ˜Ÿæ˜Ÿ</button>
        <button class="song-btn" onclick="playSong('ç”Ÿæ—¥å¿«ä¹')">ğŸ‚ ç”Ÿæ—¥å¿«ä¹</button>
        <button class="song-btn" onclick="playSong('æ¬¢ä¹é¢‚')">ğŸµ æ¬¢ä¹é¢‚</button>
        <button class="song-btn" onclick="playSong('ä¸¤è€è™')">ğŸ¯ ä¸¤è€è™</button>
    </div>

    <p class="hint">ç‚¹å‡»æŒ‰é”®æˆ–ä½¿ç”¨é”®ç›˜(A-L)å¼¹å¥</p>

    <script>
        const notes = [
            { note: 'C', freq: 261.63, key: 'a', name: '1' },
            { note: 'D', freq: 293.66, key: 's', name: '2' },
            { note: 'E', freq: 329.63, key: 'd', name: '3' },
            { note: 'F', freq: 349.23, key: 'f', name: '4' },
            { note: 'G', freq: 392.00, key: 'g', name: '5' },
            { note: 'A', freq: 440.00, key: 'h', name: '6' },
            { note: 'B', freq: 493.88, key: 'j', name: '7' },
            { note: 'C2', freq: 523.25, key: 'k', name: '1' }
        ];

        const blackNotes = [
            { note: 'Cs', freq: 277.18, key: 'w', name: '1#' },
            { note: 'Ds', freq: 311.13, key: 'e', name: '2#' },
            { note: 'Fs', freq: 369.99, key: 't', name: '4#' },
            { note: 'Gs', freq: 415.30, key: 'y', name: '5#' },
            { note: 'As', freq: 466.16, key: 'u', name: '6#' }
        ];

        let audioContext = null;

        function initAudio() {
            if (!audioContext) {
                audioContext = new (window.AudioContext || window.webkitAudioContext)();
            }
        }

        function playNote(freq, duration = 0.5) {
            initAudio();

            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();

            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);

            oscillator.frequency.value = freq;
            oscillator.type = 'sine';

            gainNode.gain.setValueAtTime(0.5, audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + duration);

            oscillator.start(audioContext.currentTime);
            oscillator.stop(audioContext.currentTime + duration);
        }

        function createPiano() {
            const piano = document.getElementById('piano');

            // ç™½é”®
            notes.forEach((n, i) => {
                const key = document.createElement('div');
                key.className = 'white-key';
                key.textContent = n.name;
                key.onclick = () => {
                    playNote(n.freq);
                    key.classList.add('playing');
                    showNote(n.note);
                    setTimeout(() => key.classList.remove('playing'), 100);
                };
                piano.appendChild(key);

                // é»‘é”®
                if (i < notes.length - 1 && [0, 1, 3, 4, 5].includes(i)) {
                    const blackKeyIndex = [0, 1, 3, 4, 5].indexOf(i);
                    const bn = blackNotes[blackKeyIndex];
                    const blackKey = document.createElement('div');
                    blackKey.className = 'black-key';
                    blackKey.onclick = (e) => {
                        e.stopPropagation();
                        playNote(bn.freq);
                        blackKey.classList.add('playing');
                        showNote(bn.note);
                        setTimeout(() => blackKey.classList.remove('playing'), 100);
                    };
                    piano.appendChild(blackKey);
                }
            });
        }

        function showNote(note) {
            document.getElementById('noteDisplay').textContent = note;
        }

        // æ­Œæ›²
        const songs = {
            'å°æ˜Ÿæ˜Ÿ': [
                { freq: 261.63, len: 0.5 }, { freq: 261.63, len: 0.5 },
                { freq: 392.00, len: 0.5 }, { freq: 392.00, len: 0.5 },
                { freq: 440.00, len: 0.5 }, { freq: 440.00, len: 0.5 },
                { freq: 392.00, len: 1 },
                { freq: 349.23, len: 0.5 }, { freq: 349.23, len: 0.5 },
                { freq: 329.63, len: 0.5 }, { freq: 329.63, len: 0.5 },
                { freq: 293.66, len: 0.5 }, { freq: 293.66, len: 0.5 },
                { freq: 261.63, len: 1 }
            ],
            'ç”Ÿæ—¥å¿«ä¹': [
                { freq: 293.66, len: 0.5 }, { freq: 329.63, len: 0.5 },
                { freq: 293.66, len: 1 }, { freq: 392.00, len: 1 },
                { freq: 440.00, len: 1 }, { freq: 392.00, len: 1 },
                { freq: 293.66, len: 0.5 }, { freq: 329.63, len: 0.5 },
                { freq: 293.66, len: 1 }, { freq: 523.25, len: 1 },
                { freq: 440.00, len: 1 }, { freq: 392.00, len: 1 }
            ],
            'æ¬¢ä¹é¢‚': [
                { freq: 329.63, len: 0.5 }, { freq: 329.63, len: 0.5 }, { freq: 349.23, len: 0.5 }, { freq: 392.00, len: 0.5 },
                { freq: 392.00, len: 0.5 }, { freq: 349.23, len: 0.5 }, { freq: 329.63, len: 0.5 }, { freq: 293.66, len: 0.5 },
                { freq: 261.63, len: 0.5 }, { freq: 261.63, len: 0.5 }, { freq: 293.66, len: 0.5 }, { freq: 329.63, len: 0.5 },
                { freq: 329.63, len: 0.75 }, { freq: 293.66, len: 0.25 }, { freq: 293.66, len: 1 }
            ],
            'ä¸¤è€è™': [
                { freq: 293.66, len: 0.5 }, { freq: 329.63, len: 0.5 }, { freq: 349.23, len: 0.5 }, { freq: 293.66, len: 0.5 },
                { freq: 349.23, len: 0.5 }, { freq: 329.63, len: 0.5 }, { freq: 293.66, len: 0.5 }, { freq: 261.63, len: 0.5 },
                { freq: 293.66, len: 0.5 }, { freq: 392.00, len: 0.5 }, { freq: 261.63, len: 0.5 }, { freq: 349.23, len: 0.5 },
                { freq: 329.63, len: 0.5 }, { freq: 293.66, len: 0.5 }, { freq: 293.66, len: 0.5 }, { freq: 261.63, len: 0.5 },
                { freq: 293.66, len: 0.5 }, { freq: 329.63, len: 0.5 }, { freq: 349.23, len: 0.5 }, { freq: 293.66, len: 0.5 },
                { freq: 349.23, len: 0.5 }, { freq: 329.63, len: 0.5 }, { freq: 293.66, len: 0.5 }, { freq: 261.63, len: 0.5 },
                { freq: 293.66, len: 0.5 }, { freq: 261.63, len: 0.5 }, { freq: 329.63, len: 0.5 }, { freq: 293.66, len: 0.5 },
                { freq: 349.23, len: 0.5 }, { freq: 329.63, len: 0.5 }, { freq: 293.66, len: 0.5 }, { freq: 261.63, len: 0.5 }
            ]
        };

        let isPlaying = false;

        async function playSong(name) {
            if (isPlaying) return;

            isPlaying = true;
            const btn = event.target;
            btn.classList.add('playing');

            const song = songs[name];
            let time = 0;

            for (const n of song) {
                playNote(n.freq, n.len * 0.9);
                await new Promise(r => setTimeout(r, n.len * 500));
            }

            btn.classList.remove('playing');
            isPlaying = false;
        }

        // é”®ç›˜äº‹ä»¶
        document.addEventListener('keydown', (e) => {
            if (e.repeat) return;

            const note = notes.find(n => n.key === e.key);
            if (note) {
                playNote(note.freq);
                const keys = document.querySelectorAll('.white-key');
                const index = notes.indexOf(note);
                if (keys[index]) {
                    keys[index].classList.add('playing');
                    setTimeout(() => keys[index].classList.remove('playing'), 100);
                }
            }

            const blackNote = blackNotes.find(n => n.key === e.key);
            if (blackNote) {
                playNote(blackNote.freq);
                const keys = document.querySelectorAll('.black-key');
                const index = blackNotes.indexOf(blackNote);
                if (keys[index]) {
                    keys[index].classList.add('playing');
                    setTimeout(() => keys[index].classList.remove('playing'), 100);
                }
            }
        });

        createPiano();
    </script>
</body>
</html>
