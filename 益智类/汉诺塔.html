<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ê±âËØ∫Â°î</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            min-height: 100vh;
            background: linear-gradient(135deg, #654ea3 0%, #eaafc8 100%);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            padding: 20px;
        }

        h1 {
            color: #fff;
            font-size: 2.5rem;
            margin-bottom: 15px;
            text-shadow: 0 0 20px rgba(255, 255, 255, 0.3);
        }

        .info-bar {
            display: flex;
            gap: 30px;
            margin-bottom: 20px;
        }

        .info-item {
            background: rgba(255, 255, 255, 0.3);
            padding: 10px 20px;
            border-radius: 20px;
            color: #fff;
            font-size: 1.1rem;
        }

        .game-container {
            background: rgba(255, 255, 255, 0.9);
            padding: 30px;
            border-radius: 25px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        .level-select {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 20px;
        }

        .level-btn {
            padding: 10px 20px;
            font-size: 1rem;
            border: none;
            border-radius: 15px;
            cursor: pointer;
            background: #ecf0f1;
            color: #7f8c8d;
            transition: all 0.2s ease;
        }

        .level-btn.active {
            background: #9b59b6;
            color: white;
        }

        .towers {
            display: flex;
            justify-content: center;
            gap: 60px;
            margin: 30px 0;
        }

        .tower {
            display: flex;
            flex-direction: column;
            align-items: center;
            cursor: pointer;
            padding: 10px;
            border-radius: 10px;
            transition: all 0.2s ease;
        }

        .tower:hover {
            background: rgba(155, 89, 182, 0.1);
        }

        .tower.selected {
            background: rgba(155, 89, 182, 0.2);
            box-shadow: 0 0 20px rgba(155, 89, 182, 0.4);
        }

        .base {
            width: 150px;
            height: 10px;
            background: #8e44ad;
            border-radius: 5px;
            margin-top: auto;
        }

        .pole {
            width: 10px;
            height: 200px;
            background: #9b59b6;
            position: relative;
        }

        .disc {
            height: 25px;
            border-radius: 15px;
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            transition: all 0.3s ease;
            box-shadow: 0 3px 10px rgba(0,0,0,0.2);
        }

        .tower-0 .disc:nth-child(1) { width: 60px; bottom: 5px; background: #e74c3c; }
        .tower-0 .disc:nth-child(2) { width: 90px; bottom: 35px; background: #e67e22; }
        .tower-0 .disc:nth-child(3) { width: 120px; bottom: 65px; background: #f1c40f; }
        .tower-0 .disc:nth-child(4) { width: 150px; bottom: 95px; background: #2ecc71; }
        .tower-0 .disc:nth-child(5) { width: 180px; bottom: 125px; background: #3498db; }
        .tower-0 .disc:nth-child(6) { width: 210px; bottom: 155px; background: #9b59b6; }

        .tower-1 .disc:nth-child(1), .tower-2 .disc:nth-child(1) { width: 60px; bottom: 5px; background: #e74c3c; }
        .tower-1 .disc:nth-child(2), .tower-2 .disc:nth-child(2) { width: 90px; bottom: 35px; background: #e67e22; }
        .tower-1 .disc:nth-child(3), .tower-2 .disc:nth-child(3) { width: 120px; bottom: 65px; background: #f1c40f; }
        .tower-1 .disc:nth-child(4), .tower-2 .disc:nth-child(4) { width: 150px; bottom: 95px; background: #2ecc71; }
        .tower-1 .disc:nth-child(5), .tower-2 .disc:nth-child(5) { width: 180px; bottom: 125px; background: #3498db; }
        .tower-1 .disc:nth-child(6), .tower-2 .disc:nth-child(6) { width: 210px; bottom: 155px; background: #9b59b6; }

        .message {
            font-size: 1.3rem;
            color: #333;
            margin: 15px 0;
            text-align: center;
        }

        .btn {
            padding: 12px 30px;
            font-size: 1rem;
            background: linear-gradient(145deg, #e74c3c, #c0392b);
            color: white;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 5px;
        }

        .btn:hover {
            transform: translateY(-2px);
        }

        .win-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }

        .win-content {
            background: white;
            padding: 50px;
            border-radius: 30px;
            text-align: center;
            animation: pop 0.5s ease;
        }

        .win-content h2 {
            font-size: 2.5rem;
            color: #27ae60;
            margin-bottom: 15px;
        }

        @keyframes pop {
            0% { transform: scale(0.5); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }
    </style>
</head>
<body>
    <h1>üóº Ê±âËØ∫Â°î</h1>

    <div class="info-bar">
        <div class="info-item">Ê≠•Êï∞: <span id="moves">0</span></div>
    </div>

    <div class="game-container">
        <div class="level-select">
            <button class="level-btn" onclick="setLevel(3)">3Â±Ç</button>
            <button class="level-btn active" onclick="setLevel(4)">4Â±Ç</button>
            <button class="level-btn" onclick="setLevel(5)">5Â±Ç</button>
            <button class="level-btn" onclick="setLevel(6)">6Â±Ç</button>
        </div>

        <div class="message" id="message">ÈÄâÊã©Ëµ∑ÂßãÂ°îÔºåÁÇπÂáªÁßªÂä®</div>

        <div class="towers">
            <div class="tower tower-0" id="tower0" onclick="clickTower(0)">
                <div class="pole"></div>
                <div class="base"></div>
            </div>
            <div class="tower tower-1" id="tower1" onclick="clickTower(1)">
                <div class="pole"></div>
                <div class="base"></div>
            </div>
            <div class="tower tower-2" id="tower2" onclick="clickTower(2)">
                <div class="pole"></div>
                <div class="base"></div>
            </div>
        </div>

        <button class="btn" onclick="resetGame()">üîÑ ÈáçÊñ∞ÂºÄÂßã</button>
    </div>

    <div class="win-overlay" id="winOverlay">
        <div class="win-content">
            <h2>üéâ ÊÅ≠Âñú!</h2>
            <p>ÂÆåÊàêÊ∏∏Êàè!</p>
            <p>ÂÖ±Áî® <span id="finalMoves">0</span> Ê≠•</p>
            <button class="btn" onclick="closeAndRestart()">ÂÜçÁé©‰∏ÄÊ¨°</button>
        </div>
    </div>

    <script>
        let level = 4;
        let towers = [[], [], []];
        let selectedTower = null;
        let moves = 0;

        function setLevel(l) {
            level = l;
            document.querySelectorAll('.level-btn').forEach((btn, i) => {
                btn.classList.toggle('active', i + 3 === l);
            });
            resetGame();
        }

        function resetGame() {
            moves = 0;
            selectedTower = null;
            document.getElementById('moves').textContent = '0';
            document.getElementById('message').textContent = 'ÈÄâÊã©Ëµ∑ÂßãÂ°îÔºåÁÇπÂáªÁßªÂä®';
            document.getElementById('winOverlay').style.display = 'none';

            // ÂàùÂßãÂåñÂ°î
            towers = [[], [], []];
            for (let i = level; i >= 1; i--) {
                towers[0].push(i);
            }

            renderTowers();
            updateTowerStyles();
        }

        function renderTowers() {
            for (let t = 0; t < 3; t++) {
                const tower = document.getElementById(`tower${t}`);
                // ÁßªÈô§ÊóßÁöÑÁ£ÅÁõò
                tower.querySelectorAll('.disc').forEach(d => d.remove());

                // Ê∑ªÂä†Á£ÅÁõò
                towers[t].forEach((size, index) => {
                    const disc = document.createElement('div');
                    disc.className = 'disc';
                    // Ê†πÊçÆÂ§ßÂ∞èËÆ°ÁÆó‰ΩçÁΩÆ
                    disc.style.bottom = (5 + index * 30) + 'px';
                    // Ê†πÊçÆÂ§ßÂ∞èËÆæÁΩÆÈ¢úËâ≤
                    const colors = ['#e74c3c', '#e67e22', '#f1c40f', '#2ecc71', '#3498db', '#9b59b6'];
                    disc.style.background = colors[size - 1] || '#9b59b6';
                    disc.style.width = (40 + size * 25) + 'px';
                    tower.appendChild(disc);
                });
            }
        }

        function updateTowerStyles() {
            for (let t = 0; t < 3; t++) {
                const tower = document.getElementById(`tower${t}`);
                tower.classList.toggle('selected', selectedTower === t);
            }
        }

        function clickTower(towerIndex) {
            if (selectedTower === null) {
                // Á¨¨‰∏ÄÊ¨°ÁÇπÂáª - ÈÄâÊã©Ëµ∑ÂßãÂ°î
                if (towers[towerIndex].length > 0) {
                    selectedTower = towerIndex;
                    document.getElementById('message').textContent = 'ÈÄâÊã©ÁõÆÊ†áÂ°î';
                }
            } else {
                // Á¨¨‰∫åÊ¨°ÁÇπÂáª - ÁßªÂä®
                if (towerIndex === selectedTower) {
                    // ÂèñÊ∂àÈÄâÊã©
                    selectedTower = null;
                    document.getElementById('message').textContent = 'ÈÄâÊã©Ëµ∑ÂßãÂ°îÔºåÁÇπÂáªÁßªÂä®';
                } else {
                    // Â∞ùËØïÁßªÂä®
                    if (canMove(selectedTower, towerIndex)) {
                        moveDisc(selectedTower, towerIndex);
                        moves++;
                        document.getElementById('moves').textContent = moves;

                        // Ê£ÄÊü•ËÉúÂà©
                        if (towers[2].length === level) {
                            setTimeout(() => {
                                document.getElementById('finalMoves').textContent = moves;
                                document.getElementById('winOverlay').style.display = 'flex';
                            }, 300);
                        }
                    }
                }
            }

            renderTowers();
            updateTowerStyles();
        }

        function canMove(from, to) {
            if (towers[from].length === 0) return false;
            if (towers[to].length === 0) return true;

            const fromTop = towers[from][towers[from].length - 1];
            const toTop = towers[to][towers[to].length - 1];

            return fromTop < toTop;
        }

        function moveDisc(from, to) {
            const disc = towers[from].pop();
            towers[to].push(disc);
            selectedTower = null;
            document.getElementById('message').textContent = 'ÈÄâÊã©Ëµ∑ÂßãÂ°îÔºåÁÇπÂáªÁßªÂä®';
        }

        function closeAndRestart() {
            document.getElementById('winOverlay').style.display = 'none';
            resetGame();
        }

        resetGame();
    </script>
</body>
</html>
