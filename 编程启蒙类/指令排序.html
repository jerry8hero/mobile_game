<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æŒ‡ä»¤æ’åº</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            min-height: 100vh;
            background: linear-gradient(135deg, #ee0979 0%, #ff6a00 100%);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
            padding: 15px;
            user-select: none;
        }

        h1 {
            color: #fff;
            font-size: 2rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .info-bar {
            display: flex;
            gap: 20px;
            margin-bottom: 10px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .info-item {
            background: rgba(255,255,255,0.25);
            padding: 8px 18px;
            border-radius: 20px;
            color: #fff;
            font-size: 1.1rem;
        }

        .game-area {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
            max-width: 400px;
        }

        .level-display {
            background: #fff;
            padding: 15px 30px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
        }

        .level-display h2 {
            color: #333;
            font-size: 1.3rem;
            margin-bottom: 8px;
        }

        .level-display p {
            color: #666;
            font-size: 0.95rem;
        }

        .task-container {
            background: rgba(255,255,255,0.2);
            border-radius: 15px;
            padding: 15px;
            width: 100%;
        }

        .task-title {
            color: #fff;
            text-align: center;
            margin-bottom: 10px;
            font-size: 1rem;
        }

        .command-slots {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            justify-content: center;
            min-height: 50px;
            background: rgba(0,0,0,0.2);
            border-radius: 10px;
            padding: 10px;
            margin-bottom: 10px;
        }

        .slot {
            width: 50px;
            height: 50px;
            background: rgba(255,255,255,0.3);
            border: 2px dashed rgba(255,255,255,0.5);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
        }

        .slot.filled {
            background: #fff;
            border-style: solid;
            border-color: #27ae60;
        }

        .command-options {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .command-btn {
            width: 50px;
            height: 50px;
            border: none;
            border-radius: 10px;
            font-size: 1.8rem;
            cursor: pointer;
            background: #fff;
            box-shadow: 0 3px 10px rgba(0,0,0,0.2);
            transition: all 0.15s;
        }

        .command-btn:hover {
            transform: scale(1.1);
        }

        .command-btn:active {
            transform: scale(0.95);
        }

        .command-btn.used {
            opacity: 0.3;
            pointer-events: none;
        }

        .result-area {
            background: #fff;
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            width: 100%;
            display: none;
        }

        .result-area.show {
            display: block;
        }

        .result-area h3 {
            font-size: 1.5rem;
            margin-bottom: 10px;
        }

        .result-area.success h3 {
            color: #27ae60;
        }

        .result-area.fail h3 {
            color: #e74c3c;
        }

        .buttons {
            display: flex;
            gap: 12px;
            justify-content: center;
            flex-wrap: wrap;
        }

        button.action-btn {
            padding: 12px 28px;
            font-size: 1rem;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            box-shadow: 0 3px 15px rgba(0,0,0,0.2);
            transition: all 0.2s;
        }

        button.action-btn:hover {
            transform: translateY(-2px);
        }

        .btn-check { background: #27ae60; color: #fff; }
        .btn-reset { background: #f39c12; color: #fff; }
        .btn-next { background: #3498db; color: #fff; }

        .instructions {
            color: rgba(255,255,255,0.9);
            font-size: 0.9rem;
            text-align: center;
            background: rgba(255,255,255,0.1);
            padding: 12px;
            border-radius: 10px;
        }

        @media (max-width: 350px) {
            .slot, .command-btn { width: 40px; height: 40px; font-size: 1.5rem; }
        }
    </style>
</head>
<body>
    <h1>ğŸ“ æŒ‡ä»¤æ’åº</h1>

    <div class="info-bar">
        <div class="info-item">å…³å¡: <span id="level">1</span></div>
        <div class="info-item">å¾—åˆ†: <span id="score">0</span></div>
    </div>

    <div class="game-area">
        <div class="level-display">
            <h2 id="taskTitle">è®©å°æœºå™¨äººèµ°åˆ°æ˜Ÿæ˜Ÿå¤„</h2>
            <p id="taskHint">è¯·æŒ‰æ­£ç¡®é¡ºåºç‚¹å‡»æŒ‡ä»¤</p>
        </div>

        <div class="task-container">
            <div class="task-title">ğŸ”¢ æŒ‰é¡ºåºæ’åˆ—æŒ‡ä»¤</div>

            <div class="command-slots" id="commandSlots">
                <!-- æ§½ä½ç”±JSç”Ÿæˆ -->
            </div>

            <div class="command-options" id="commandOptions">
                <!-- é€‰é¡¹ç”±JSç”Ÿæˆ -->
            </div>
        </div>

        <div class="buttons">
            <button class="action-btn btn-reset" onclick="resetLevel()">ğŸ”„ é‡ç½®</button>
            <button class="action-btn btn-check" onclick="checkAnswer()">âœ… æ£€æŸ¥</button>
        </div>

        <div class="result-area" id="resultArea">
            <h3 id="resultTitle"></h3>
            <p id="resultMessage"></p>
            <div class="buttons">
                <button class="action-btn btn-reset" onclick="retry()">ğŸ”„ é‡è¯•</button>
                <button class="action-btn btn-next" id="nextBtn" onclick="nextLevel()">ä¸‹ä¸€å…³ â†’</button>
            </div>
        </div>

        <p class="instructions">
            è§‚å¯Ÿé¢˜ç›®è¦æ±‚ï¼ŒæŠŠæŒ‡ä»¤æŒ‰æ­£ç¡®é¡ºåºæ’åˆ—èµ·æ¥ï¼<br>
            ç‚¹å‡»æŒ‡ä»¤é€‰é¡¹å¡«å…¥æ§½ä½ï¼Œå†ç‚¹å‡»æ§½ä½å¯ä»¥å–å‡º
        </p>
    </div>

    <script>
        // æ¸¸æˆçŠ¶æ€
        let currentLevel = 0;
        let score = 0;
        let slots = [];
        let usedCommands = new Set();

        // å…³å¡æ•°æ®
        const levels = [
            // Level 1: ç®€å•3æ­¥
            {
                task: "è®©æœºå™¨äººå‘å³èµ°2æ ¼",
                solution: ['right', 'right'],
                commands: [
                    {id: 'right', icon: 'â¡ï¸'},
                    {id: 'down', icon: 'â¬‡ï¸'},
                    {id: 'left', icon: 'â¬…ï¸'},
                    {id: 'up', icon: 'â¬†ï¸'}
                ]
            },
            // Level 2: 4æ­¥
            {
                task: "å…ˆå‘å³ï¼Œå†å‘ä¸‹ï¼Œç„¶åå‘å³",
                solution: ['right', 'down', 'right'],
                commands: [
                    {id: 'down', icon: 'â¬‡ï¸'},
                    {id: 'right', icon: 'â¡ï¸'},
                    {id: 'up', icon: 'â¬†ï¸'},
                    {id: 'left', icon: 'â¬…ï¸'}
                ]
            },
            // Level 3: ä¸Šä¸‹å·¦å³
            {
                task: "å…ˆå‘ä¸Š2æ ¼ï¼Œå†å‘å³1æ ¼",
                solution: ['up', 'up', 'right'],
                commands: [
                    {id: 'right', icon: 'â¡ï¸'},
                    {id: 'up', icon: 'â¬†ï¸'},
                    {id: 'down', icon: 'â¬‡ï¸'},
                    {id: 'left', icon: 'â¬…ï¸'},
                    {id: 'left', icon: 'â¬…ï¸'}
                ]
            },
            // Level 4: 5æ­¥
            {
                task: "å³å³ï¼Œä¸‹ä¸‹ï¼Œå·¦å·¦",
                solution: ['right', 'right', 'down', 'down', 'left', 'left'],
                commands: [
                    {id: 'down', icon: 'â¬‡ï¸'},
                    {id: 'right', icon: 'â¡ï¸'},
                    {id: 'left', icon: 'â¬…ï¸'},
                    {id: 'up', icon: 'â¬†ï¸'},
                    {id: 'right', icon: 'â¡ï¸'},
                    {id: 'down', icon: 'â¬‡ï¸'},
                    {id: 'left', icon: 'â¬…ï¸'}
                ]
            },
            // Level 5: æŒ‘æˆ˜
            {
                task: "ä¸Šï¼Œå³ï¼Œä¸‹ï¼Œå³ï¼Œä¸‹ï¼Œå·¦",
                solution: ['up', 'right', 'down', 'right', 'down', 'left'],
                commands: [
                    {id: 'right', icon: 'â¡ï¸'},
                    {id: 'down', icon: 'â¬‡ï¸'},
                    {id: 'up', icon: 'â¬†ï¸'},
                    {id: 'left', icon: 'â¬…ï¸'},
                    {id: 'down', icon: 'â¬‡ï¸'},
                    {id: 'right', icon: 'â¡ï¸'},
                    {id: 'left', icon: 'â¬…ï¸'}
                ]
            }
        ];

        // åˆå§‹åŒ–
        function initGame() {
            loadLevel(currentLevel);
        }

        // åŠ è½½å…³å¡
        function loadLevel(levelIndex) {
            const level = levels[levelIndex];

            // é‡ç½®çŠ¶æ€
            slots = [];
            usedCommands = new Set();

            // åˆ›å»ºæ§½ä½
            const slotsContainer = document.getElementById('commandSlots');
            slotsContainer.innerHTML = '';
            for (let i = 0; i < level.solution.length; i++) {
                const slot = document.createElement('div');
                slot.className = 'slot';
                slot.dataset.index = i;
                slot.onclick = () => removeFromSlot(i);
                slotsContainer.appendChild(slot);
            }

            // åˆ›å»ºæŒ‡ä»¤é€‰é¡¹
            const optionsContainer = document.getElementById('commandOptions');
            optionsContainer.innerHTML = '';
            // éšæœºæ‰“ä¹±é¡ºåº
            const shuffled = [...level.commands].sort(() => Math.random() - 0.5);
            shuffled.forEach(cmd => {
                const btn = document.createElement('button');
                btn.className = 'command-btn';
                btn.textContent = cmd.icon;
                btn.dataset.id = cmd.id;
                btn.onclick = () => addToSlot(cmd.id);
                optionsContainer.appendChild(btn);
            });

            // æ›´æ–°UI
            document.getElementById('level').textContent = levelIndex + 1;
            document.getElementById('taskTitle').textContent = level.task;
            document.getElementById('resultArea').classList.remove('show', 'success', 'fail');
        }

        // æ·»åŠ æŒ‡ä»¤åˆ°æ§½ä½
        function addToSlot(cmdId) {
            const level = levels[currentLevel];
            const emptyIndex = slots.findIndex(s => s === null);

            if (emptyIndex === -1) return; // æ§½ä½å·²æ»¡

            slots[emptyIndex] = cmdId;
            usedCommands.add(cmdId);
            updateSlots();
        }

        // ä»æ§½ä½ç§»é™¤æŒ‡ä»¤
        function removeFromSlot(index) {
            if (slots[index] === null) return;

            const cmdId = slots[index];
            slots[index] = null;
            usedCommands.delete(cmdId);
            updateSlots();
        }

        // æ›´æ–°æ§½ä½æ˜¾ç¤º
        function updateSlots() {
            const level = levels[currentLevel];
            const slotElements = document.querySelectorAll('.slot');
            const cmdElements = document.querySelectorAll('.command-btn');

            // æ›´æ–°æ§½ä½
            slotElements.forEach((slot, i) => {
                if (slots[i]) {
                    const cmd = level.commands.find(c => c.id === slots[i]);
                    slot.textContent = cmd.icon;
                    slot.classList.add('filled');
                } else {
                    slot.textContent = '';
                    slot.classList.remove('filled');
                }
            });

            // æ›´æ–°é€‰é¡¹çŠ¶æ€
            cmdElements.forEach(btn => {
                const countUsed = slots.filter(s => s === btn.dataset.id).length;
                const totalAvailable = level.commands.filter(c => c.id === btn.dataset.id).length;
                if (countUsed >= totalAvailable) {
                    btn.classList.add('used');
                } else {
                    btn.classList.remove('used');
                }
            });
        }

        // æ£€æŸ¥ç­”æ¡ˆ
        function checkAnswer() {
            const level = levels[currentLevel];

            // æ£€æŸ¥æ˜¯å¦å¡«æ»¡
            if (slots.some(s => s === null)) {
                alert('è¯·å¡«æ»¡æ‰€æœ‰æ§½ä½ï¼');
                return;
            }

            // æ£€æŸ¥ç­”æ¡ˆ
            let correct = true;
            for (let i = 0; i < level.solution.length; i++) {
                if (slots[i] !== level.solution[i]) {
                    correct = false;
                    break;
                }
            }

            // æ˜¾ç¤ºç»“æœ
            const resultArea = document.getElementById('resultArea');
            const resultTitle = document.getElementById('resultTitle');
            const resultMessage = document.getElementById('resultMessage');
            const nextBtn = document.getElementById('nextBtn');

            resultArea.classList.remove('success', 'fail');

            if (correct) {
                score += (5 - currentLevel) * 20;
                document.getElementById('score').textContent = score;
                resultArea.classList.add('success');
                resultTitle.textContent = 'ğŸ‰ ç­”å¯¹äº†ï¼';
                resultMessage.textContent = `å¤ªæ£’äº†ï¼è·å¾— ${(5 - currentLevel) * 20} åˆ†`;
                nextBtn.style.display = 'inline-block';
            } else {
                resultArea.classList.add('fail');
                resultTitle.textContent = 'âŒ ä¸å¯¹å“¦';
                resultMessage.textContent = 'å†æƒ³æƒ³ï¼ŒæŒ‡ä»¤é¡ºåºå¯¹äº†å—ï¼Ÿ';
                nextBtn.style.display = 'none';
            }

            resultArea.classList.add('show');
        }

        // é‡è¯•
        function retry() {
            document.getElementById('resultArea').classList.remove('show', 'success', 'fail');
            loadLevel(currentLevel);
        }

        // é‡ç½®
        function resetLevel() {
            loadLevel(currentLevel);
        }

        // ä¸‹ä¸€å…³
        function nextLevel() {
            document.getElementById('resultArea').classList.remove('show', 'success', 'fail');
            if (currentLevel < levels.length - 1) {
                currentLevel++;
            } else {
                currentLevel = 0;
                alert('ğŸŠ æ­å–œé€šå…³æ‰€æœ‰å…³å¡ï¼');
            }
            loadLevel(currentLevel);
        }

        initGame();
    </script>
</body>
</html>
